#:import utils kivy.utils
#:import Factory kivy.factory.Factory

MenuManager:
    MenuScreen:
    MultiplayerScreen:
    T3Main:

<MenuScreen>:
    name: "menuscreen"
    BoxLayout:
        canvas:
            Color:
                rgba: 0.6978, 0.3847, 0.3542, 0.4359
            Rectangle:
                size: self.width, self.height
    GridLayout:
        padding: "20dp"
        spacing: "5dp"
        cols: 1
        pos_hint: {"center_x": .5, "center_y": .5}
        size_hint: .5, 1
        Label:
            markup: True
            text: "[b]MENU[/b]"
            font_size: "25dp"
            size_hint: .1, .09
        Label:
            size_hint: .1, .05
        Button:
            text: "New Game"
            size_hint: .1, .15
            background_color: (0, 0, 0, 0) # 0.345, 0.867, 0.486, 0.5
            background_normal: ''
#            background_color: utils.get_color_from_hex("#00FFCE")
            on_press:
                root.manager.current = "maingame"
                root.manager.transition.direction = "left"
            canvas.before:
                Color:
                    rgba: 0.345, 0.867, 0.486, 0.5
                RoundedRectangle:
                    size: self.size
                    pos: self.pos
                    radius: [30,1, 30, 1]
        Button:
            text: "Multiplayer"
            size_hint: .1, .15
            background_color: (0, 0, 0, 0)
            background_normal: ''
            on_press:
                root.manager.current = "multiplayerscreen"
                root.manager.transition.direction = "left"
            canvas.before:
                Color:
                    rgba: 0.345, 0.867, 0.486, 0.5
                RoundedRectangle:
                    size: self.size
                    pos: self.pos
                    radius: [30,1, 30, 1]
        Button:
            text: "Set Alias"
            size_hint: .1, .15
            background_color: (0, 0, 0, 0)
            background_normal: ''
            on_press: Factory.set_alias().open()
            canvas.before:
                Color:
                    rgba: 0.345, 0.867, 0.486, 0.5
                RoundedRectangle:
                    size: self.size
                    pos: self.pos
                    radius: [30,1, 30, 1]
        Button:
            text: "More Games"
            size_hint: .1, .15
            background_color: (0, 0, 0, 0)
            background_normal: ''
            canvas.before:
                Color:
                    rgba: 0.345, 0.867, 0.486, 0.5
                RoundedRectangle:
                    size: self.size
                    pos: self.pos
                    radius: [30, 0, 30, 0]
        Label:

<set_alias@Popup>
    id: alias
    title: 'Set alias name.'
    size_hint: .8, .3
    pos_hint: {"top": .8}
    BoxLayout:
        orientation: 'vertical'
#        size_hint:
        TextInput:
            id: aliasname
            multiline: False
        GridLayout:
            cols: 2
            size_hint: 1, .5
            Button:
                text: "Ok"
#                on_release:
            Button:
                text: "Cancel"
                on_release: root.dismiss()

<MultiplayerScreen>:
    name: "multiplayerscreen"
    BoxLayout:
        orientation: "vertical"
        spacing: "10dp"
        padding: "20dp"

        Button:
            size_hint: .08, .02
            pos_hint: {"x": 0, "y": .95}
            text: "<<Menu"
            on_press:
                root.manager.current = "menuscreen"
                root.manager.transition.direction = "right"

        Label:
            text: "The Host starts first, hence assigned 'X'"
            font_size: "15dp"
            color: 0.345, 0.867, 0.486, 0.5
            size_hint: .7, .05
            pos_hint: {"center_x": .5}

        GridLayout:
            padding: "15dp"
            spacing: "15dp"
            cols: 2
            pos_hint: {"center_x": .5, "center_y": .5}
            size_hint: .7, .3

            Button:
                id: host
                background_color: "#00FFCE"
#                background_normal: ""
                text: "HOST GAME"
                font_size: "20dp"
                size_hint: .1, .5
                on_release: root.host_game()
            Button:
                id: join
                background_color: "#00FFCE"
#                background_normal: ""
                text: "JOIN GAME"
                font_size: "20dp"
                size_hint: .1, .5
                on_release: root.join()
        Label:
            id: conn
            background_color: 0.345, 0.867, 0.486, 0.5
            text: "__"
            font_size: "15dp"
            size_hint: 1, .2
            pos_hint: {"center_x": .5}
        Label:
            id: status
            background_color: 0.345, 0.867, 0.486, 0.5
#            text: "Connection Status"
            font_size: "15dp"
            size_hint: 1, .2
            pos_hint: {"center_x": .5}
        Label:
            size_hint: 1, .6
        Label:
            size_hint: 1, .6



<T3Main>:
    name: "maingame"
    BoxLayout
        canvas:
            Color:
                rgb: 0.445767, 0.23465, 0.445
            Rectangle:
                size: self.width, self.height

        orientation: "vertical"
        padding: "20dp"

        Button:
            size_hint: .08, .055
            pos_hint: {"x": 0}
            text: "<<Menu"
            on_press:
                root.manager.current = "menuscreen"
                root.manager.transition.direction = "right"

        Label:
            markup: True
            text: "[b]TIC TAC TOE[/b]"
            font_name: "fonts/Eurostile.ttf"
            font_size: "40dp"
            size_hint: .5, .1
            pos_hint: {"center_x": .5}

        GridLayout:
            cols: 3
            pos_hint: {"center_x": .5}
            size_hint: .8, .1
            spacing: "10dp"
            Label:
                id: Alias1
                markup: True
                text: "Alias 1"
                font_size: "20dp"
                font_name: "fonts/Lcd.ttf"
                halign: "center"

            Label:
                id: display
                font_size: "25dp"
                text: "X GOES FIRST"
                font_name: "fonts/Lcd.ttf"
                halign: "center"
                pos_hint: {"center_x": .5}

            Label:
                id: Alias2
                text: "Alias 2"
                font_size: "20dp"
                font_name: "fonts/Lcd.ttf"
                halign: "center"
            ProgressBar:
                id: player1
                max: 10
            Label:
                id: emptylabel
                font_size: "25dp"
                font_name: "fonts/Lcd.ttf"
            ProgressBar:
                id: player2
                max: 10

        BoxLayout:
            orientation: "vertical"
            size_hint: .7, 1
            pos_hint: {'center_x': .5}

            GridLayout:
                padding: "15dp"
                cols: 3

                Button:
                    id: b1
                    on_release: root.play(b1)
                    text: ""
                    font_name: "fonts/Lcd.ttf"
                    font_size: "150dp"
                Button:
                    id: b2
                    on_release: root.play(b2)
                    text: ""
                    font_name: "fonts/Lcd.ttf"
                    font_size: "150dp"
                Button:
                    id: b3
                    on_release: root.play(b3)
                    text: ""
                    font_name: "fonts/Lcd.ttf"
                    font_size: "150dp"
                Button:
                    id: b4
                    on_release: root.play(b4)
                    text: ""
                    font_name: "fonts/Lcd.ttf"
                    font_size: "150dp"
                Button:
                    id: b5
                    on_release: root.play(b5)
                    text: ""
                    font_name: "fonts/Lcd.ttf"
                    font_size: "150dp"
                Button:
                    id: b6
                    on_release: root.play(b6)
                    text: ""
                    font_name: "fonts/Lcd.ttf"
                    font_size: "150dp"
                Button:
                    id: b7
                    on_release: root.play(b7)
                    text: ""
                    font_name: "fonts/Lcd.ttf"
                    font_size: "150dp"
                Button:
                    id: b8
                    on_release: root.play(b8)
                    text: ""
                    font_name: "fonts/Lcd.ttf"
                    font_size: "150dp"
                Button:
                    id: b9
                    on_release: root.play(b9)
                    text: ""
                    font_name: "fonts/Lcd.ttf"
                    font_size: "150dp"

        Button:
            id: restart
            text: "ROUND 1"
            font_name: "fonts/Eurostile.ttf"
            font_size: "30dp"
            on_release: root.restart_game()
            size_hint: .3, .1
            pos_hint: {"center_x": .5}

